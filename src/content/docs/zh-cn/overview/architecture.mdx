---
title: 架构与组件
description: 控制面、执行面与隔离执行（Runner / Sandbox）怎么协作。
---

本页用“组件视角”解释 Maia 的运行方式，方便你在部署、排障、扩容时快速定位问题。

## 两个平面：控制面 vs 执行面

- **App（控制面）**
  - Web UI
  - 调度与状态机（scheduler/state machine）
  - SQLite（状态与输出的持久化）
  - 实时事件流（SSE：日志/事件/回放）

- **Runner（执行面）**
  - 负责启动/销毁 sandbox 容器
  - 收集并流式回传 stdout/stderr 与执行事件
  - 将执行产物（outputs/files/artifacts）落盘到数据目录

## 为什么要拆成两个服务？

- **安全与隔离**：把“不可信/高风险的执行”放在执行面，用容器隔离
- **稳定性**：控制面负责“状态与编排”，不因为单次执行崩溃而丢状态
- **扩展性**：执行压力主要在 Runner，可按需求独立扩容

## 关键依赖与配置

- **`RUNNER_TOKEN`**：App 与 Runner 必须一致（否则 Runner 无法注册/授权）
- **数据目录**：持久化 SQLite 与运行产物（见「部署与运维 → 数据目录与备份」）
- **Sandbox 镜像**：Runner 需要能拉取或使用本地构建的 sandbox 镜像
